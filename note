finish rewriting types
change engines to be context based to remove overlapss